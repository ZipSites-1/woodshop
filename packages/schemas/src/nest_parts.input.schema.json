{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://woodshop.dev/schemas/nest_parts.input.json",
  "title": "NestPartsInput",
  "type": "object",
  "additionalProperties": false,
  "properties": {
    "project_id": { "type": "string" },
    "seed": { "type": "integer", "minimum": 0, "default": 0 },
    "strategy": {
      "type": "string",
      "enum": ["skyline"],
      "default": "skyline"
    },
    "kerf_mm": { "type": "number", "minimum": 0, "default": 0.5 },
    "grain_rule": {
      "type": "string",
      "enum": ["strict", "relaxed"],
      "default": "strict"
    },
    "parts": {
      "type": "array",
      "minItems": 1,
      "items": {
        "type": "object",
        "additionalProperties": false,
        "properties": {
          "part_id": { "type": "string" },
          "length_mm": { "type": "number", "minimum": 0 },
          "width_mm": { "type": "number", "minimum": 0 },
          "quantity": { "type": "integer", "minimum": 1 },
          "allow_rotation": { "type": "boolean", "default": false }
        },
        "required": ["part_id", "length_mm", "width_mm", "quantity"]
      }
    },
    "stock": {
      "type": "array",
      "minItems": 1,
      "items": {
        "type": "object",
        "additionalProperties": false,
        "properties": {
          "sheet_id": { "type": "string" },
          "length_mm": { "type": "number", "minimum": 0 },
          "width_mm": { "type": "number", "minimum": 0 },
          "quantity": { "type": "integer", "minimum": 1 }
        },
        "required": ["sheet_id", "length_mm", "width_mm", "quantity"]
      }
    }
  },
  "required": ["project_id", "parts", "stock"]
}
